<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:t="sap.ui.table">

    <t:TreeTable
        id="wbsTreeTable"
        rows="{
            path: 'viewData>/WBS',
            parameters: {
                arrayNames: ['children'],
                numberOfExpandedLevels: 2
            }
        }"
        selectionMode="Single"
        visibleRowCount="18"
        enableColumnReordering="false"
        alternateRowColors="true"
        class="sapUiSmallMarginTop sapUiSizeCompact">
        
        <t:extension>
            <OverflowToolbar>
                <Title text="Cấu trúc WBS &amp; Kế hoạch chi tiết" level="H2"/>
                <ToolbarSpacer/>
                <Button text="Thêm công việc" icon="sap-icon://add" type="Emphasized" press=".onAddNewTask" />
                <Button text="Xóa" icon="sap-icon://delete" type="Reject" press=".onDeleteTask" />
            </OverflowToolbar>
        </t:extension>

        <t:columns>
            <t:Column width="30rem">
                <t:label><Label text="Hạng mục / Công việc chi tiết" design="Bold"/></t:label>
                <t:template>
                    <HBox alignItems="Center">
                        <core:Icon 
                            src="{= ${viewData>Type} === 'WBS' ? 'sap-icon://folder-blank' : 'sap-icon://activity-items' }" 
                            class="sapUiTinyMarginEnd" 
                            color="{= ${viewData>Type} === 'WBS' ? '#346187' : '#e67e22' }"/>
                        <Text text="{viewData>DisplayName}" 
                              renderWhitespace="true"
                              class="{= ${viewData>Type} === 'WBS' ? 'sapUiSelectable font-bold' : '' }"/>
                    </HBox>
                </t:template>
            </t:Column>

            <t:Column width="15rem" hAlign="Center">
                <t:label><Label text="Mã định danh" /></t:label>
                <t:template>
                    <Text text="{viewData>CustomId}" />
                </t:template>
            </t:Column>

            <t:Column width="10rem" hAlign="Center">
                <t:label><Label text="Ngày bắt đầu" /></t:label>
                <t:template>
                    <Text text="{path: 'viewData>PlanStartDate', formatter: '.formatDate'}" />
                </t:template>
            </t:Column>

            <t:Column width="10rem" hAlign="Center">
                <t:label><Label text="Trạng thái" /></t:label>
                <t:template>
                    <ObjectStatus 
                        text="{viewData>StatusText}"
                        state="{viewData>StatusState}"/>
                </t:template>
            </t:Column>
        </t:columns>
    </t:TreeTable>
</core:FragmentDefinition>