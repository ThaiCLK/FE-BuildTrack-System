<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:t="sap.ui.table">

    <t:TreeTable id="wbsTreeTable"
        rows="{path: 'viewData>/WBS', parameters: {arrayNames: ['children'], numberOfExpandedLevels: 2}}"
        selectionMode="Single"
        visibleRowCount="21"
        rowHeight="30"
        class="myCustomWideContent"
        cellClick=".onGanttTaskClick">

        <t:columns>
            <t:Column width="18rem">
                <t:label><Label text="Work progress" design="Bold"/></t:label>
                <t:template>
                    <HBox alignItems="Center">
                        <core:Icon src="{= ${viewData>Type} === 'WBS' ? 'sap-icon://folder-blank' : 'sap-icon://activity-items'}"
                                   class="sapUiTinyMarginEnd" 
                                   color="{= ${viewData>Type} === 'WBS' ? '#346187' : '#e67e22'}"/>
                        <Text text="{viewData>DisplayName}" wrapping="false" tooltip="{viewData>DisplayName}"/>
                    </HBox>
                </t:template>
            </t:Column>

            <t:Column width="6rem" hAlign="Center">
                <t:label><Label text="Start"/></t:label>
                <t:template>
                    <Text text="{path: 'viewData>PlanStartDate', formatter: '.formatDate'}"/>
                </t:template>
            </t:Column>

            <t:Column width="6rem" hAlign="Center">
                <t:label><Label text="End"/></t:label>
                <t:template>
                    <Text text="{path: 'viewData>PlanEndDate', formatter: '.formatDate'}"/>
                </t:template>
            </t:Column>

            <t:Column width="{viewConfig>/totalWidth}" resizable="false">
                <t:label>
                    <VBox width="{viewConfig>/totalWidth}" renderType="Bare">
                        <HBox items="{path: 'viewConfig>/timeScale'}" renderType="Bare" height="25px">
                            <items>
                                <FlexBox width="{viewConfig>monthWidth}" 
                                         justifyContent="Center" alignItems="Center" 
                                         class="gantt-month-header gantt-no-shrink">
                                    <Text text="{viewConfig>monthLabel}"/>
                                </FlexBox>
                            </items>
                        </HBox>
                        
                        <HBox items="{path: 'viewConfig>/timeScale'}" renderType="Bare" height="20px">
    <items>
        <HBox items="{path: 'viewConfig>days'}" renderType="Bare" class="gantt-no-shrink">
            <items>
                <FlexBox width="{viewConfig>dayWidth}" 
                         justifyContent="Center" alignItems="Center"
                         class="gantt-day-border gantt-no-shrink">
                    
                    <Text text="{viewConfig>dayLabel}" 
                          visible="{= ${viewConfig>dayLabel} !== ''}"
                          wrapping="false"
                          />
                          
                </FlexBox>
                                    </items>
                                </HBox>
                            </items>
                        </HBox>
                    </VBox>
                </t:label>

                <t:template>
                    <FlexBox width="{viewConfig>/totalWidth}" 
                             renderType="Bare" 
                             class="gantt-cell-container" 
                             alignItems="Center">
                        
                        <core:HTML content='&lt;div style="width: {path: &apos;viewData>PlanStartDate&apos;, formatter: &apos;.calcMargin&apos;}; flex-shrink: 0;"&gt;&lt;/div&gt;' />

                        <FlexBox visible="{= ${viewData>Type} === 'WBS'}"
                                 width="{parts: ['viewData>PlanStartDate', 'viewData>PlanEndDate'], formatter: '.calcWidth'}"
                                 class="gantt-bar-phase gantt-no-shrink"
                                 renderType="Bare">                               
                        </FlexBox>

                        <FlexBox visible="{= ${viewData>Type} === 'PLAN'}"
                                 width="{parts: ['viewData>PlanStartDate', 'viewData>PlanEndDate'], formatter: '.calcWidth'}"
                                 class="gantt-bar-task gantt-no-shrink"
                                 alignItems="Center"
                                 renderType="Bare">
                             <Text text="NC [{path: 'viewData>PlanQty', type: 'sap.ui.model.type.Integer'}]" 
                                   class="gantt-bar-end-label" />
                        </FlexBox>
                        
                    </FlexBox>
                </t:template>
            </t:Column>
        </t:columns>
    </t:TreeTable>
</core:FragmentDefinition>